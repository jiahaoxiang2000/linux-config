#compdef blivedm

autoload -U is-at-least

_blivedm() {
    typeset -A opt_args
    typeset -a _arguments_options
    local ret=1

    if is-at-least 5.2; then
        _arguments_options=(-s -S -C)
    else
        _arguments_options=(-s -C)
    fi

    local context curcontext="$curcontext" state line
    _arguments "${_arguments_options[@]}" : \
'--config=[Path to configuration file]:PATH:_files' \
'--cookies=[Cookies for Bilibili authentication (optional - will auto-detect from browser if not provided)]:COOKIES:_default' \
'--room-id=[Room ID to connect to]:ROOM_ID:_default' \
'--tts-server=[TTS REST API server URL]:URL:_default' \
'--tts-voice=[TTS voice ID (e.g., "zh-CN-XiaoxiaoNeural")]:VOICE:_default' \
'--tts-backend=[TTS backend ("edge", "xtts", "piper")]:BACKEND:_default' \
'--tts-quality=[TTS audio quality ("low", "medium", "high")]:QUALITY:_default' \
'--tts-format=[TTS audio format (e.g., "wav")]:FORMAT:_default' \
'--tts-sample-rate=[TTS sample rate (e.g., 22050, 44100)]:RATE:_default' \
'--tts-volume=[TTS audio volume (0.0 to 1.0)]:VOLUME:_default' \
'--tts-command=[Local TTS command (e.g., "say", "espeak-ng")]:COMMAND:_default' \
'--tts-args=[Comma-separated arguments for TTS command]:ARGS:_default' \
'--generate-completion=[Generate shell completion script (bash, zsh, fish, powershell, elvish)]:SHELL:(bash elvish fish powershell zsh)' \
'--print-config[Print effective configuration and exit]' \
'--debug[Enable debug logging]' \
'--auto-reply[Enable auto reply plugin]' \
'-h[Print help]' \
'--help[Print help]' \
'-V[Print version]' \
'--version[Print version]' \
&& ret=0
}

(( $+functions[_blivedm_commands] )) ||
_blivedm_commands() {
    local commands; commands=()
    _describe -t commands 'blivedm commands' commands "$@"
}

if [ "$funcstack[1]" = "_blivedm" ]; then
    _blivedm "$@"
else
    compdef _blivedm blivedm
fi
